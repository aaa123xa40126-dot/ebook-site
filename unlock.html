<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>火種解鎖儀式・正式版</title>
<style>
.glowBg {
  position: fixed;
  inset: 0;
  z-index: 0;
  background: #000;
  transition: background 3.5s ease;
}
.run .glowBg {
  background: #fff;
}
:root{
  --orange:#ffb86b; --orange2:#ff8c1a; --gold:#ffdca8;
}
html,body{
  margin:0;padding:0;height:100%;
  background:#000;color:var(--orange);
  font-family:'DFKai-SB','標楷體','Times New Roman',Times,serif;
  overflow:hidden;
}

/* 按鈕閃爍火光 */
#ignite {
  position: relative !important;
  z-index: 9999 !important;
  pointer-events: auto !important;
  display:inline-block;
  border:1px solid var(--orange);
  padding:10px 20px;
  border-radius:12px;
  color:var(--orange);
  text-decoration:none;
  cursor:pointer;
  animation:breathe 1.6s ease-in-out infinite alternate;
  transition:all .2s ease;
}
#ignite:hover{
  color:var(--gold);
  box-shadow:0 0 18px rgba(255,184,107,.65), inset 0 0 8px rgba(255,184,107,.25);
}
@keyframes breathe{
  from{filter:brightness(1);}
  to{filter:brightness(1.25);}
}

.maskLayer, .whiteCore, .goldGlow, .edgeNoise, .sparks, .fireText {
  pointer-events:none !important;
}

/* 主體 */
.wrap{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:5;
}
.panel{
  width:min(720px,92%);
  border:1px solid var(--orange);
  border-radius:14px;
  padding:28px 22px;
  text-align:center;
  line-height:1.9;
  background:#000;
  box-shadow:0 0 24px rgba(255,184,107,.08) inset;
}
.title{font-size:1.3rem;letter-spacing:2px;margin-bottom:12px;}
.input{
  width:95%;max-width:700px;padding:14px 16px;font-size:1.1rem;
  border:1px solid color-mix(in oklab,var(--orange),#000 40%);
  border-radius:10px;background:#0b0b0b;color:var(--orange);
  margin:0 auto 20px;display:block;
}

/* 動畫遮罩 */
.maskLayer{
  position:fixed;inset:0;z-index:10;display:none;
}
.whiteCore,.goldGlow,.edgeNoise{position:absolute;inset:0;opacity:0;}
.whiteCore{
  background: radial-gradient(circle at 50% 50%, #fff5e1 0%, rgba(255,245,225,0) 65%);
  clip-path: circle(120% at 50% 50%);
}
.goldGlow{
  background: radial-gradient(40% 40% at 50% 50%, rgba(255,184,107,.35) 0%, rgba(255,140,26,.28) 30%, rgba(255,140,26,0) 60%);
  mix-blend-mode:screen;
  clip-path: circle(120% at 50% 50%);
}
.edgeNoise{
  --noise:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="240" height="240"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="3"/></filter><rect width="100%" height="100%" filter="url(%23n)" fill="black"/></svg>');
  background: radial-gradient(closest-side,rgba(0,0,0,0) 60%,rgba(0,0,0,0.35) 75%,rgba(0,0,0,0.7) 85%,rgba(0,0,0,0.95) 92%,rgba(0,0,0,1) 100%);
  -webkit-mask:var(--noise);mask:var(--noise);clip-path:circle(120% at 50% 50%);
  mix-blend-mode:multiply;opacity:0;
}

/* 火星 */
.sparks{position:fixed;inset:0;pointer-events:none;z-index:12;display:none;}
.spark{position:absolute;width:3px;height:3px;border-radius:50%;opacity:0;
  filter:drop-shadow(0 0 6px rgba(255,184,107,.9));}
@keyframes sparkInward{
  0%{transform:translate(var(--sx),var(--sy)) scale(1);opacity:0;}
  10%{opacity:1;}
  100%{transform:translate(0,0) scale(0.7);opacity:0;}
}

/* 文字動畫 */
.fadeContent{transition:opacity 2s ease;opacity:0;}
@keyframes shrinkIn{
  0%{clip-path:circle(120% at 50% 50%);opacity:1;}
  70%{clip-path:circle(12% at 50% 50%);opacity:1;}
  100%{clip-path:circle(6% at 50% 50%);opacity:0;}
}
.run .whiteCore{animation:shrinkIn 2s cubic-bezier(.25,.6,.3,1) forwards;opacity:1;}
.run .goldGlow{animation:shrinkIn 2s cubic-bezier(.25,.6,.3,1) forwards;opacity:1;}
.run .edgeNoise{animation:shrinkIn 2s ease forwards;opacity:.55;}
.fireText{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
  font-size:1.6rem;color:var(--orange2);z-index:20;opacity:0;
}
@keyframes textFade{
  0%{opacity:0;}
  10%{opacity:1;}
  80%{opacity:1;}
  100%{opacity:0;}
}
</style>
</head>
<body>
<div class="glowBg"></div>
<div class="wrap" id="contentWrap">
  <div class="panel">
    <div class="title">請輸入您的專屬火種序號</div>
    <input class="input" placeholder="例如：A3F9KZ72XZ">
    <a id="ignite" class="btn">點燃火種</a>
  </div>
</div>

<div class="maskLayer" id="mask">
  <div class="whiteCore"></div>
  <div class="goldGlow"></div>
  <div class="edgeNoise"></div>
</div>

<div class="sparks" id="sparks"></div>
<div class="fireText" id="fireText">火種被點燃了....</div>

<script>
function playBurnSound(){
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  const dur = 6.5, sr = ctx.sampleRate, len = sr * dur;
  const buf = ctx.createBuffer(1, len, sr);
  const data = buf.getChannelData(0);
  for (let i = 0; i < len; i++) data[i] = (Math.random() * 2 - 1) * 0.15;
  for (let k = 0; k < 150; k++){
    const p = Math.floor(Math.random() * len);
    const w = Math.floor(sr * (0.002 + Math.random() * 0.004));
    const a = 0.5 + Math.random() * 1.0;
    for (let i = 0; i < w && p + i < len; i++){
      data[p + i] += a * Math.exp(-i / (w * 0.5));
    }
  }
  const src = ctx.createBufferSource();
  src.buffer = buf;
  const g = ctx.createGain();
  const now = ctx.currentTime;
  g.gain.setValueAtTime(0.0001, now);
  g.gain.exponentialRampToValueAtTime(0.6, now + 0.3);
  g.gain.exponentialRampToValueAtTime(0.0001, now + dur);
  src.connect(g);
  g.connect(ctx.destination);
  src.start();
}

function createSparks(){
  const cont=document.getElementById('sparks');
  cont.innerHTML='';cont.style.display='block';
  const W=innerWidth,H=innerHeight,colors=['#ffb86b','#ff9d4d','#ffdca8','#fff2cc','#ffe7b1'];
  for(let i=0;i<90;i++){
    const s=document.createElement('div');s.className='spark';
    const ang=Math.random()*Math.PI*2,r=Math.max(W,H)*0.6;
    const startX=Math.cos(ang)*r+W/2,startY=Math.sin(ang)*r+H/2;
    const tx=(W/2-startX),ty=(H/2-startY);
    s.style.left=startX+'px';s.style.top=startY+'px';
    s.style.background=colors[Math.floor(Math.random()*colors.length)];
    s.style.setProperty('--sx',tx+'px');s.style.setProperty('--sy',ty+'px');
    const dur=1.2+Math.random()*0.8,delay=Math.random()*0.2;
    s.style.animation=`sparkInward ${dur}s ease-out ${delay}s forwards`;
    cont.appendChild(s);
  }
}

function ignite(){
  document.body.classList.add('run');
  const btn=document.getElementById('ignite');
  btn.style.pointerEvents='none';
  const mask=document.getElementById('mask');
  mask.style.display='block';
  mask.classList.add('run');
  const content=document.getElementById('contentWrap');
  content.classList.add('fadeContent');
  createSparks();
  playBurnSound();

  setTimeout(()=>{
    document.getElementById('fireText').style.animation='textFade 2.5s ease forwards';
  },2000);

  localStorage.setItem("fireUnlocked", "true");

  setTimeout(()=>{
    window.location.href='main.html';
  },7000);
}

window.onload=()=>{
  const btn=document.getElementById('ignite');
  btn.addEventListener('click',ignite);
};
</script>
</body>
</html>
